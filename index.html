<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mesa de Jogo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Cole aqui os mesmos estilos <style> do seu mesa.html anterior */
        body { background: linear-gradient(to bottom right, #111827, #1f2937); color: #d1d5db; font-family: 'Inter', sans-serif; overflow: hidden; }
        #mesa { display: flex; flex-wrap: wrap; gap: 16px; padding: 24px; align-content: flex-start; min-height: 100vh; background-image: radial-gradient(circle at center, rgba(255, 255, 255, 0.05) 0%, transparent 70%); }
        .carta-na-mesa { width: 120px; height: 168px; border-radius: 8px; background-size: cover; background-position: center; border: 3px solid #4f46e5; box-shadow: 0 6px 12px rgba(0,0,0,0.4); position: relative; transform: scale(0.8) translateY(20px); opacity: 0; animation: surgir 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; overflow: hidden; }
        .carta-na-mesa::after { content: attr(data-title); position: absolute; bottom: 0; left: 0; width: 100%; background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); color: white; font-size: 12px; font-weight: bold; padding: 12px 4px 4px 4px; text-align: center; text-shadow: 1px 1px 2px black; }
        @keyframes surgir { to { transform: scale(1) translateY(0); opacity: 1; } }
        #limpar-mesa-btn { position: fixed; bottom: 20px; right: 20px; z-index: 100; }
    </style>
</head>
<body>
    <div id="mesa"></div>
    <button id="limpar-mesa-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-full shadow-lg">
        Limpar Mesa
    </button>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <script>
        // COLE AQUI O SEU OBJETO firebaseConfig
        const firebaseConfig = {
           apiKey: "AIzaSyCSFhUNp0weU09S13kZmUd0-J50-eHW1YU",
            authDomain: "farland-cards.firebaseapp.com",
            projectId: "farland-cards",
            storageBucket: "farland-cards.firebasestorage.app",
            messagingSenderId: "347739610452",
            appId: "1:347739610452:web:d3b172dea431944365fcc1",
            measurementId: "G-8T74ETC4GV"
        };

        // Inicializa o Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const mesaRef = database.ref('cartas'); // O "endereço" das nossas cartas no banco

        const mesaDiv = document.getElementById('mesa');
        const limparMesaBtn = document.getElementById('limpar-mesa-btn');

        // Função para adicionar uma carta à tela
        function adicionarCartaNaTela(dadosDaCarta, idUnico) {
            if (document.getElementById(idUnico)) return; // Evita duplicatas

            const cartaDiv = document.createElement('div');
            cartaDiv.id = idUnico;
            cartaDiv.className = 'carta-na-mesa';
            cartaDiv.style.backgroundImage = `url(${dadosDaCarta.imagemUrl})`;
            cartaDiv.setAttribute('data-title', dadosDaCarta.nome);
            mesaDiv.appendChild(cartaDiv);
        }

        // FICA OUVINDO QUANDO UMA NOVA CARTA É ADICIONADA no Firebase
        mesaRef.on('child_added', (snapshot) => {
            const idUnico = snapshot.key; // A chave única da carta jogada
            const dadosDaCarta = snapshot.val(); // Os dados da carta
            adicionarCartaNaTela(dadosDaCarta, idUnico);
        });

        // FICA OUVINDO QUANDO AS CARTAS SÃO REMOVIDAS do Firebase
        mesaRef.on('child_removed', () => {
            // Simplesmente limpa a mesa inteira
            mesaDiv.innerHTML = '';
        });
        
        // Limpa todas as cartas do banco de dados
        limparMesaBtn.addEventListener('click', () => {
            if (confirm('Tem certeza que deseja limpar a mesa para todos?')) {
                mesaRef.remove();
            }
        });

    </script>
</body>
</html>
